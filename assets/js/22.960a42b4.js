(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{368:function(e,t,i){"use strict";i.r(t);var r=i(43),o=Object(r.a)({},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[i("h1",{attrs:{id:"deploy"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#deploy"}},[e._v("#")]),e._v(" Deploy")]),e._v(" "),i("p",[e._v("All "),i("code",[e._v(".sh")]),e._v(" scripts is in "),i("code",[e._v("Scripts/")])]),e._v(" "),i("p",[e._v("To deploy to the server you must perform the following steps:")]),e._v(" "),i("ul",[i("li",[e._v("Run "),i("code",[e._v("build.sh")]),e._v(" script.")]),e._v(" "),i("li",[e._v("Prepare the parameters for the "),i("code",[e._v("publi.sh")]),e._v(" script by renaming"),i("code",[e._v("PUBLISH.template")]),e._v(" to "),i("code",[e._v("PUBLISH")]),e._v(" and edit the settings in the file.")]),e._v(" "),i("li",[e._v("Run "),i("code",[e._v("publi.sh")]),e._v(" script.")])]),e._v(" "),i("h2",{attrs:{id:"creating-build"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#creating-build"}},[e._v("#")]),e._v(" Creating Build")]),e._v(" "),i("h3",{attrs:{id:"build-sh-script"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#build-sh-script"}},[e._v("#")]),e._v(" build.sh script")]),e._v(" "),i("p",[e._v("The script works out of the box.")]),e._v(" "),i("p",[e._v("After starting the whole project is going to the "),i("code",[e._v("build")]),e._v(" directory.")]),e._v(" "),i("p",[e._v("The client part is placed in "),i("code",[e._v("build/wwwroot")]),e._v(".")]),e._v(" "),i("p",[e._v("The default file is "),i("code",[e._v("BUILD")]),e._v(", or specify the settings file with the first argument")]),e._v(" "),i("div",{staticClass:"language- extra-class"},[i("pre",{pre:!0,attrs:{class:"language-text"}},[i("code",[e._v('"build.sh /path/to/BUILD_VARS"\n')])])]),i("h2",{attrs:{id:"build-script-settings"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#build-script-settings"}},[e._v("#")]),e._v(" BUILD Script Settings")]),e._v(" "),i("ul",[i("li",[i("code",[e._v('PROJECT_NAME="SunEngine"')]),e._v("             - the name of the project, used to display in the console")]),e._v(" "),i("li",[i("code",[e._v('PROJECT_ROOT="auto"')]),e._v("                  - path to the project root directory"),i("br"),e._v("\nThe value of "),i("code",[e._v("auto")]),e._v(": the current directory or the directory above is determined by the contents in the directory of the "),i("code",[e._v(".SunEngineRoot")]),e._v(" file")]),e._v(" "),i("li",[i("code",[e._v('SERVER_PATH="${PROJECT_ROOT}/Server"')]),e._v(" - path to the server part of the project (DotNet solution)")]),e._v(" "),i("li",[i("code",[e._v('CLIENT_PATH="${PROJECT_ROOT}/Client"')]),e._v(" - the path to the client part of the project (Quasar project)")]),e._v(" "),i("li",[i("code",[e._v('CONFIG_PATH="${PROJECT_ROOT}/Config"')]),e._v(" - the path to the directory with the project configuration")]),e._v(" "),i("li",[i("code",[e._v('BUILD_PATH="${PROJECT_ROOT}/build"')]),e._v("   - the path to which the resulting project assembly will be placed")]),e._v(" "),i("li",[i("code",[e._v('NPM_UTIL="yarn"')]),e._v("                      - installer of npm packages (yarn or npm)")])]),e._v(" "),i("h2",{attrs:{id:"installation-on-the-server"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#installation-on-the-server"}},[e._v("#")]),e._v(" Installation on the server")]),e._v(" "),i("h3",{attrs:{id:"script-publi-sh"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#script-publi-sh"}},[e._v("#")]),e._v(" Script publi.sh")]),e._v(" "),i("p",[e._v("Before starting, you need to edit the parameters in the "),i("code",[e._v("PUBLISH")]),e._v(" script settings file.")]),e._v(" "),i("p",[e._v("The "),i("code",[e._v("publi.sh")]),e._v(" script writes the"),i("code",[e._v("build")]),e._v(" directory to the server, overwriting all the files, and the "),i("code",[e._v("Config")]),e._v(" directory writes only if it is not already on the server.")]),e._v(" "),i("p",[e._v("The default file is "),i("code",[e._v("PUBLISH")]),e._v(", or specify the settings file with the first argument")]),e._v(" "),i("div",{staticClass:"language- extra-class"},[i("pre",{pre:!0,attrs:{class:"language-text"}},[i("code",[e._v('"publi.sh /path/to/PUBLISH_VARS"\n')])])]),i("p",[e._v("In order for the script to be able to fully work out the user "),i("code",[e._v("username")]),e._v(" on the server (under which the script runs), add "),i("code",[e._v("www-data")]),e._v(", "),i("code",[e._v("systemd-journal")]),e._v(","),i("code",[e._v("systemd-network")]),e._v(", "),i("code",[e._v("systemd-network")]),e._v(", "),i("code",[e._v("systemd -resolve")]),e._v(". This can be done by editing the file "),i("code",[e._v("/etc/group")]),e._v(".")]),e._v(" "),i("h2",{attrs:{id:"publish-script-settings"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#publish-script-settings"}},[e._v("#")]),e._v(" PUBLISH script settings")]),e._v(" "),i("ul",[i("li",[i("code",[e._v('PROJECT_NAME="SunEngineDemo"')]),e._v("            - the name of the project, used to display in the console")]),e._v(" "),i("li",[i("code",[e._v('LOCAL_BUILD_PATH="/path/to/local/build"')]),e._v(" - the path to the build directory of the project, must match the "),i("code",[e._v("BUILD_PATH")]),e._v(" from the file "),i("code",[e._v("BUILD")])]),e._v(" "),i("li",[i("code",[e._v('REMOTE_USER="username"')]),e._v("                  - username under which the connection to the server will be made")]),e._v(" "),i("li",[i("code",[e._v('REMOTE_HOST="111.111.111.111"')]),e._v("           - IP or domain of the server host")]),e._v(" "),i("li",[i("code",[e._v('REMOTE_DIRECTORY="/remote/dir/path"')]),e._v("     - the path to the directory on the server where the download will be performed")]),e._v(" "),i("li",[i("code",[e._v('REMOTE_DIRECTORY_OWNER="www-data"')]),e._v("       - the user who owns "),i("code",[e._v("REMOTE_DIRECTORY")]),e._v(" on the server")]),e._v(" "),i("li",[i("code",[e._v('REMOTE_DIRECTORY_GROUP="www-data"')]),e._v("       - the group of which belongs to "),i("code",[e._v("REMOTE_DIRECTORY")]),e._v(" on the server")]),e._v(" "),i("li",[i("code",[e._v('REMOTE_SYSTEMD_SERVICE_NAME="demo.sunengine.site"')]),e._v(" - the name of the service "),i("code",[e._v("systemd")]),e._v(" to restart after loading")])]),e._v(" "),i("h2",{attrs:{id:"writing-configuration-files"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#writing-configuration-files"}},[e._v("#")]),e._v(" Writing configuration files")]),e._v(" "),i("p",[e._v("After building "),i("code",[e._v("build.sh")]),e._v(" and publishing "),i("code",[e._v("publi.sh")]),e._v(", you need to configure the server to edit the files in the "),i("code",[e._v("Config")]),e._v(" directory on the server, this is done once.\nIt is necessary to register the correct database settings in "),i("code",[e._v("DataBaseConnection.json")])]),e._v(" "),i("p",[e._v("Other settings as needed.")]),e._v(" "),i("p",[e._v("The "),i("code",[e._v("Config/Init")]),e._v(" directory is used to start initializing the site database - the "),i("code",[e._v("dotnet SunEngine.dll init migrate")]),e._v(" command.")]),e._v(" "),i("h2",{attrs:{id:"upgrading-sunengine-on-the-server-to-the-latest-version-from-thegithub-repository"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#upgrading-sunengine-on-the-server-to-the-latest-version-from-thegithub-repository"}},[e._v("#")]),e._v(" Upgrading "),i("code",[e._v("SunEngine")]),e._v(" on the server to the latest version from the"),i("code",[e._v("GitHub")]),e._v(" repository")]),e._v(" "),i("h3",{attrs:{id:"script-update-sh"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#script-update-sh"}},[e._v("#")]),e._v(" Script: update.sh")]),e._v(" "),i("p",[e._v("The script works out of the box provided the "),i("code",[e._v("publi.sh")]),e._v(" script is configured.")]),e._v(" "),i("p",[e._v("The script takes the latest version from the master branch of the repository, overwriting everything that was before except for "),i("code",[e._v("Config")])]),e._v(" "),i("p",[e._v("And sequentially runs "),i("code",[e._v("build.sh")]),e._v(" and "),i("code",[e._v("publi.sh")]),e._v(" scripts.")]),e._v(" "),i("h2",{attrs:{id:"update-script-settings"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#update-script-settings"}},[e._v("#")]),e._v(" UPDATE script settings")]),e._v(" "),i("ul",[i("li",[i("code",[e._v('PROJECT_NAME="SunEngineDemo"')]),e._v("     - the name of the project, used to display in the console")]),e._v(" "),i("li",[i("code",[e._v('PROJECT_ROOT="auto"')]),e._v("              - the path to the root directory of the project\nThe value of "),i("code",[e._v("auto")]),e._v(": the current directory or the directory above is determined by the contents in the directory of the "),i("code",[e._v(".SunEngineRoot")]),e._v(" file.")]),e._v(" "),i("li",[i("code",[e._v('BUILD_SCRIPT_PATH="./build.sh"')]),e._v("   - the path to the build script")]),e._v(" "),i("li",[i("code",[e._v('PUBLISH_SCRIPT_PATH="./publi.sh"')]),e._v(" - the path to the publication script")])])])}),[],!1,null,null,null);t.default=o.exports}}]);